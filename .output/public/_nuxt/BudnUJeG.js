import{am as S,i as E,P as q,an as v,n as C,p as T,q as j}from"./Bo0c-sWM.js";const O="$s";function _(...e){const n=typeof e[e.length-1]=="string"?e.pop():void 0;typeof e[0]!="string"&&e.unshift(n);const[c,i]=e;if(!c||typeof c!="string")throw new TypeError("[nuxt] [useState] key must be a string: "+c);if(i!==void 0&&typeof i!="function")throw new Error("[nuxt] [useState] init must be a function: "+i);const s=O+c,t=q(),a=S(t.payload.state,s);if(a.value===void 0&&i){const u=i();if(E(u))return t.payload.state[s]=u,u;a.value=u}return a}var p=(e=>(e.Info="info",e.Success="success",e.Warn="warn",e.Error="error",e))(p||{}),l=(e=>(e.Info="Informação",e.Success="Sucesso",e.Warn="Atenção",e.Error="Erro",e))(l||{});const k=()=>{const e=v(),n=3e3;return{show:(s,t,a="info",u=n)=>{e.add({severity:a,summary:s,detail:t,life:u})},erroRequest:s=>{console.error(s.message),e.add({severity:"error",summary:"Erro",detail:"Ocorreu um erro interno no servidor",life:3e3})}}},A=()=>{const e=k();_("token");const n=(s,t="")=>{try{if(s.response.status>499&&s.response.status<=599)e.erroRequest(s);else if(s.response.status==403)e.show(l.Error,"Você não tem permissão para acessar este recurso",p.Error),t=t||"/";else if(s.response.status==404)e.show(l.Error,"Dados não encontrados",p.Error),t=t||"/";else if(s.response.status==401)t="/login",e.show(l.Error,"Você não está autenticado. Faça o login novamente",p.Error);else if(s.response.status==402)t="https://healthby.ai#planos",e.show(l.Error,"Seu plano expirou, verifique seu pagamento",p.Error);else if(s.response.status==422)i(s.response._data.errors);else{const a=s.response._data.message||s.response.statusText;e.show(l.Error,a,p.Error)}t&&setTimeout(()=>{C(t,{external:!0})},1e3)}catch(a){e.erroRequest(a)}},c=s=>{try{if(s.response.status!==401){n(s);return}const t=s.response._data.message||s.response.statusText;e.show(l.Error,t,p.Error)}catch(t){e.erroRequest(t)}},i=s=>{let t="";for(const a in s)if(Object.prototype.hasOwnProperty.call(s,a)){const u=s[a].map(g=>`- ${g}`).join(`
`);t+=`${u}
`}e.show(l.Error,t,p.Error,6e3)};return{errorRequest:n,errorLoginRequest:c}},R=e=>{try{return e?e.toISOString().split("T")[0]:null}catch{return!1}},L=e=>{try{return e?e.replace(/[^\d]/g,""):null}catch{return!1}},M=()=>{const e=j(),n=A(),c=T("token");return{login:async o=>{try{return await $fetch("login",{baseURL:e.public.apiBase,headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify(o)})}catch(r){throw n.errorLoginRequest(r),r}},logout:async()=>{try{const o=await $fetch("logout",{baseURL:e.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+c.value},method:"POST"});return c.value=null,o}catch(o){n.errorRequest(o)}},validarSessao:async()=>{try{return await $fetch("validar-sessao",{baseURL:e.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+c.value}})}catch(o){throw n.errorRequest(o),o}},recuperarSenha:async o=>{try{return await $fetch("recuperar-senha",{baseURL:e.public.apiBase,headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify(o)})}catch(r){n.errorRequest(r)}},validarTokenRedefinicao:async o=>{try{const f="validar-token-redefinicao?"+new URLSearchParams(o).toString();return await $fetch(f,{baseURL:e.public.apiBase,headers:{"Content-type":"application/json"},method:"GET"})}catch(r){n.errorRequest(r)}},redefinirSenha:async o=>{try{return await $fetch("redefinir-senha",{baseURL:e.public.apiBase,headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify(o)})}catch(r){n.errorRequest(r)}},gerarSenha:()=>{const o="abcdefghijklmnopqrstuvwxyz",r="ABCDEFGHIJKLMNOPQRSTUVWXYZ",f="0123456789",m="!@#$%&?",w=o+r+f+m,d=h=>h[Math.floor(Math.random()*h.length)],b=h=>h[Math.floor(Math.random()*h.length)],y=[d(r),d(o),d(f),d(m)];for(;y.length<8;)y.push(b(w.split("")));return y.sort(()=>Math.random()-.5),y.join("")},cadastrarNovoUsuario:async o=>{try{return await $fetch("cadastrar-usuario",{baseURL:e.public.apiBase,headers:{"Content-type":"application/json"},method:"POST",body:JSON.stringify(x(o))})}catch(r){throw n.errorRequest(r),r}}}},x=e=>(e.cpf_cnpj=e.cpf_cnpj?L(e.cpf_cnpj):null,e.data_nascimento=e.data_nascimento?R(e.data_nascimento):null,e.data_abertura=e.data_abertura?R(e.data_abertura):null,e);export{p as S,k as a,A as b,l as c,L as f,M as u};
