import L from"./C-mN_1go.js";import O from"./KEM6ktD1.js";import{s as P,u as k,e as B,b as x,_ as T,p as E,f as N}from"./Bs-sMhgS.js";import{p as $,q as D,r as j,n as G,c as V,b as o,x as J,a as p,u as c,i as z,j as U,t as q,w as S,s as F,o as I,d as C}from"./CAdTuWl1.js";import{b as M,a as H,u as K,S as Q}from"./CTGm96m6.js";import"./BNVxtKsG.js";import"./CIGutisJ.js";import"./3xjy7G5N.js";const h={path:"/sistema/controle-acesso/usuarios",roles:{listar:"usuarios-listar",visualizar:"usuarios-visualizar",criar:"usuarios-criar",editar:"usuarios-editar",excluir:"usuarios-excluir","associar-grupo":"usuarios-associar-grupo","desassociar-grupo":"usuarios-desassociar-grupo","associar-organizacao":"usuarios-associar-organizacao","desassociar-organizacao":"usuarios-desassociar-organizacao"}},W=()=>{const r=D(),a=$("token"),n=M();return{getAll:async e=>{try{return await $fetch("controle-acesso/users/buscar",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"POST",body:JSON.stringify(e)})}catch(s){n.errorRequest(s);return}},get:async e=>{try{return await $fetch(`controle-acesso/users/${e}`,{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value}})}catch(s){n.errorRequest(s,h.path);return}},post:async e=>{try{return await $fetch("controle-acesso/users",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"POST",body:JSON.stringify(e)})}catch(s){n.errorRequest(s,h.path+"/cadastrar");return}},put:async(e,s)=>{try{return await $fetch(`controle-acesso/users/${e}`,{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"PUT",body:JSON.stringify(s)})}catch(t){n.errorRequest(t,h.path+"/"+e);return}},destroy:async e=>{try{return await $fetch(`controle-acesso/users/${e}`,{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"DELETE"})}catch(s){n.errorRequest(s,h.path);return}},retornarPerfilUsuario:async()=>{try{return await $fetch("controle-acesso/users/perfil",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value}})}catch(e){throw n.errorRequest(e),e}},getGrupos:async(e,s)=>{try{return await $fetch("controle-acesso/users/"+e+"/grupos",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"POST",body:JSON.stringify(s)})}catch(t){n.errorRequest(t);return}},desassociarGrupo:async(e,s)=>{try{return await $fetch("controle-acesso/users/"+e+"/grupos/"+s,{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"DELETE"})}catch(t){n.errorRequest(t);return}},associarGrupo:async(e,s)=>{try{return await $fetch("controle-acesso/users/"+e+"/grupos/"+s,{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"POST"})}catch(t){n.errorRequest(t);return}},getGruposDisponiveis:async e=>{try{return await $fetch("controle-acesso/users/"+e+"/gruposDisponiveis",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value}})}catch(s){n.errorRequest(s);return}},getOrganizacoes:async(e,s)=>{try{return await $fetch("controle-acesso/users/"+e+"/organizacoes",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value},method:"POST",body:JSON.stringify(s)})}catch(t){n.errorRequest(t);return}},getOrganizacoesDisponiveis:async e=>{try{return await $fetch("controle-acesso/users/"+e+"/organizacoesDisponiveis",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value}})}catch(s){n.errorRequest(s);return}},getOptions:async()=>{try{return await $fetch("controle-acesso/users/options",{baseURL:r.public.apiBase,headers:{Accept:"application/json","Content-type":"application/json",Authorization:"Bearer "+a.value}})}catch{return}}}},X={class:"bg-white p-8 drop-shadow-md rounded-lg w-full lg:w-1/3 sm:mx-auto"},Y=o("div",{class:"text-center mb-7"},[o("img",{src:T,alt:"Logotipo",class:"mt-4 mb-8 h-14 mx-auto"}),o("div",{class:"text-900 text-xl font-medium my-2"}," Bem vindo! "),o("div",{class:"text-gray-600"}," FaÃ§a login para continuar ")],-1),Z=o("label",{for:"email",class:"block text-900 font-medium mb-2"},"Email",-1),ee={class:"p-error text-sm"},se=o("label",{for:"password",class:"block text-900 font-medium mb-2"},"Senha",-1),te={class:"p-error text-sm"},ae={class:"flex items-center justify-between mb-6"},oe={class:"text-center mt-4"},re=o("span",{class:"text-gray-600"},"NÃ£o tem uma conta ainda? ",-1),he={__name:"login",setup(r){P(E);const a=H(),n=K(),w=W(),g=$("token");g.value=null;const y=j(null),{handleSubmit:R}=k(),{value:l,errorMessage:f}=B("email",x().required()),{value:d,errorMessage:b}=B("password",x().required()),m=j(!1),v=R(_=>{m.value=!0,n.login(_).then(i=>{g.value=i.token,a.show(i.title,i.message,Q.Success),setTimeout(async()=>{y.value=await w.retornarPerfilUsuario(),window.localStorage.setItem("perfilUsuario",JSON.stringify(y.value)),G("/home")},1e3)}).finally(()=>{m.value=!1})});return(_,i)=>{const A=L,e=O,s=N,t=F;return I(),V("div",X,[Y,o("div",null,[o("form",{class:"grid gap-3",onSubmit:i[2]||(i[2]=J((...u)=>c(v)&&c(v)(...u),["prevent"]))},[o("div",null,[Z,p(A,{id:"email",modelValue:c(l),"onUpdate:modelValue":i[0]||(i[0]=u=>z(l)?l.value=u:null),name:"email",type:"text",class:U([{"p-invalid":c(f)},"w-full"])},null,8,["modelValue","class"]),o("span",ee,q(c(f)),1)]),o("div",null,[se,p(e,{id:"password",modelValue:c(d),"onUpdate:modelValue":i[1]||(i[1]=u=>z(d)?d.value=u:null),name:"password",class:U([{"p-invalid":c(b)},"w-full !grid"]),feedback:!1,"toggle-mask":""},null,8,["modelValue","class"]),o("span",te,q(c(b)),1)]),o("div",ae,[p(s,{to:"/recuperar-senha",class:"font-medium no-underline ml-2 text-blue-500 text-right cursor-pointer"},{default:S(()=>[C(" Esqueceu sua senha? ")]),_:1})]),p(t,{type:"submit",label:"Acessar",class:"w-full",loading:c(m)},null,8,["loading"]),o("div",oe,[re,p(s,{to:"/cadastrar",class:"font-medium no-underline text-blue-500 text-right cursor-pointer"},{default:S(()=>[C(" Cadastre-se ")]),_:1})])],32)])])}}};export{he as default};
